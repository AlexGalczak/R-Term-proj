---
title: "R Project"
author: "Alex Galczak"
date: "May 4, 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. 

Libraries in use:

```{r}
library(oceanmap)
library(ncmeta)
library(tidync)
library(tidync)
library(ggplot2)
library(mapdata)
library(dplyr)
library(tidyr)
library(tidyverse)
library(raster)
library(readr)
library(readxl)


```

First a trash generation calculations and plot in the US by type:

```{r}



epa_trash <- read_excel("./data/epa_trash.xlsx", sheet = 1)




```

Trash destinations by type:

```{r}


```

Whale casulaties figures

```{r}

```


Plastic conversion graph

```{r}


```









```{r cars}


mp1 <- fortify(map(fill=TRUE, plot=FALSE))
mp2 <- mp1
mp2$long <- mp2$long + 360
mp2$group <- mp2$group + max(mp2$group) + 1
mp <- rbind(mp1, mp2)
ggplot(aes(x = long, y = lat, group = group), data = mp) + 
  geom_path()  + 
  scale_x_continuous(limits = c(110, 300)) + 
  scale_y_continuous(limits = c(-50, 70)) 

?fortify

```



```{r}
install.packages("ggOceanMaps")
install.packages("devtools")
install.packages("ggOceanMapsData")
library("ggOceanMaps")
library("devtools")
library("ggOceanMapsData")
```



```{r}


#devtools::install_github("MikkoVihtakari/ggOceanMapsData") # required by ggOceanMaps
#devtools::install_github("MikkoVihtakari/ggOceanMaps")

#install.packages("ggOceanMapsData", repos = c("https://mikkovihtakari.github.io/drat", "https://cloud.r-project.org"))



dt <- data.frame(lon = c(-30, -30, 30, 30), lat = c(50, 80, 80, 50))

basemap(data = dt, bathymetry = TRUE) + 
  geom_polygon(data = transform_coord(dt), aes(x = lon, y = lat), color = "red", fill = NA)

basemap(limits = c(120, 180,0,66))

basemap(limits = c(-20, 20, 55, 80))

basemap(limits = c(0, 180,0,66))

basemap(limits = c(-90, 90,0,66))

basemap(limits = c(90, -90,0,66))

basemap(limits = c(-135,  135, 30, 80))

etopoPath <- "Path/To/The/ETOPO/folder" 
map.limits <- c(0, 53, 70, 82)
bound.limits <- c(-25, 75, 65, 84)
projection <- "+init=epsg:32636"

rb <- raster_bathymetry(bathy = 
            paste(etopoPath, "ETOPO1_Ice_g_gmt4.grd", sep = "/"),
          depths = 
           c(50, 100, 200, 300, 400, 500, 750, 1000, 1500, 2000, 
             3000, 4000, 5000, 6000, 10000), 
           proj.out = projection, 
           boundary = bound.limits
)
bs_bathy <- vector_bathymetry(rb)

path <- paste0("https://github.com/MikkoVihtakari/Barents-Sea-currents/raw/master/tabular/barents_currents.csv") # To make the url fit
cur <- read.csv(path)
cur <- transform_coord(cur, proj.out = projection, bind = TRUE)
## Plot the limits (required for the xspline function)
lims <- auto_limits(expand.grid(data.frame(lon = bound.limits[1:2], lat = bound.limits[3:4])), 
                    proj.out = projection)$projBound
sp::plot(lims)
## Run xspline through the nodes
tp <- lapply(unique(cur$group), function(j) {
  tmp <- cur[cur$group == j,]
  bla <- xspline(x = tmp$lon.proj, y = tmp$lat.proj, shape = -0.6, draw = FALSE)
  data.frame(long = bla$x, lat = bla$y, group = j, size = unique(tmp$size), type = unique(tmp$type))
})

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
